<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <td><button><a href="../index.html">Winfa</a></button></td>

    <title>Tu Mapa</title>

    <!-- Agrega Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

    <!-- Estilos personalizados si es necesario -->
    <style>
        #map {
            height: 600px;
        }

        .social-table {
            width: 100%;
            margin-top: 10px;
            border-collapse: collapse;
        }

        .social-table td {
            padding: 5px;
            border: 1px solid #ddd;
            text-align: center;
        }

        .social-table img {
            width: 30px; /* Ajusta el ancho de las imágenes según sea necesario */
            height: auto;
        }
    </style>
</head>
<body>
    
    <!-- Contenido principal de tu página -->
    <div id="map"></div>

    <!-- Agrega Leaflet JS -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            var map = L.map('map'); // No especificamos la ubicación inicial

            // Usa la geolocalización HTML5 para obtener la posición del usuario
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function (position) {
                    var userLocation = [position.coords.latitude, position.coords.longitude];

                    // Agrega capa de OpenStreetMap al mapa
                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '© OpenStreetMap contributors'
                    }).addTo(map);

                    // Grupos de capas
                    var grupos = {
                        Agricultura: L.layerGroup(),
                        Manufactura: L.layerGroup(),
                        Servicios: L.layerGroup()
                    };

                    // Datos de marcadores (reemplaza estos datos con los tuyos)
                    var marcadores = {
                        Agricultura: [
                            
                            // Otros marcadores...
                        ],
                        Manufactura: [
                            {
                                latitud: -19.0393989, 
                                longitud: -65.2679384,
                                sigla: "SUREÑA",
                                nombre: "Cerveza Sureña",
                                horario: "Lunes a Viernes 08:00 - 12:00 / 14:00 - 18:00",
                                direccion: "Calle Mauro Nuñez # 16",
                                origen: "Sucre - Chuquisaca - Bolivia",
                                facebook: "https://www.facebook.com/SurenaCerveza",
                                whatsapp: "https://wa.me/59176123407",
                                tiktok: null, // No tiene TikTok
                                sitioWeb: "https://www.surena.com", // Tiene un sitio web
                                correo: null, // No tiene correo
                                foto: "Edificios/edificio sureña.jpg"
                            },
                            // Otros marcadores...
                        ],
                        Servicios: [
                            {
                                latitud: -19.0471409, 
                                longitud: -65.2548899,
                                sigla: "EMAPA",
                                nombre: "",
                                horario: "Lunes a Viernes 08:00 - 12:00 / 14:00 - 18:00",
                                direccion: "Calle Avaroa # 64",
                                origen: "Sucre - Chuquisaca - Bolivia",
                                facebook: null,
                                whatsapp: null,
                                tiktok: null, // No tiene TikTok
                                sitioWeb: null,
                                correo: null, // No tiene correo
                                foto: "Edificios/edificio emapa.jpg"
                            },
                            {
                                latitud: -18.9481920, 
                                longitud: -65.122101,
                                sigla: "PARQUE RECREACIONAL ERMITA",
                                nombre: "ERMITA",
                                horario: "Lunes a Viernes 08:00 - 12:00 / 14:00 - 18:00",
                                direccion: "SALID A CBBA",
                                origen: "Sucre - Chuquisaca - Bolivia",
                                facebook: null,
                                whatsapp: null,
                                tiktok: null, // No tiene TikTok
                                sitioWeb: null,
                                correo: null, // No tiene correo
                                foto: "Edificios/edificio emapa.jpg"
                            },
                            // Otros marcadores...
                        ]
                    };

                    // Agrega marcadores a los grupos de capas
                    Object.keys(grupos).forEach(grupo => {
                        marcadores[grupo].forEach(marcador => {
                            // Genera la tabla de redes sociales según lo que tiene el marcador
                            var socialTableContent = `<table class="social-table"><tr>`;
                            if (marcador.facebook) {
                                socialTableContent += `<td><a href="${marcador.facebook}" target="_blank"><img src="facebook.png" alt="Facebook"></a></td>`;
                            }
                            if (marcador.whatsapp) {
                                socialTableContent += `<td><a href="${marcador.whatsapp}" target="_blank"><img src="whatsapp.png" alt="WhatsApp"></a></td>`;
                            }
                            if (marcador.tiktok) {
                                socialTableContent += `<td><a href="${marcador.tiktok}" target="_blank"><img src="tiktok.png" alt="TikTok"></a></td>`;
                            }
                            if (marcador.sitioWeb) {
                                socialTableContent += `<td><a href="${marcador.sitioWeb}" target="_blank"><img src="pagina.png" alt="Sitio Web"></a></td>`;
                            }
                            if (marcador.correo) {
                                socialTableContent += `<td><a href="${marcador.correo}" target="_blank"><img src="correo.jpg" alt="Correo"></a></td>`;
                            }
                            socialTableContent += `</tr></table>`;

                            var popupContent = `
                                <div style="max-width: 300px;">
                                    <h3 style="margin: 0;">${marcador.sigla}</h3>
                                    <p style="margin: 5px 0 0;">${marcador.nombre}</p>
                                    <p style="margin: 0;"><strong>Horario:</strong> ${marcador.horario}</p>
                                    <p style="margin: 0;"><strong>Dirección:</strong> ${marcador.direccion}</p>
                                    <p style="margin: 0;"><strong>Origen:</strong> ${marcador.origen}</p>
                                    <img src="${marcador.foto}" alt="Foto del marcador" style="width: 100%; max-width: 200px; margin-top: 5px;">
                                    ${socialTableContent}
                                </div>
                            `;

                            var marcadorLayer = L.marker([marcador.latitud, marcador.longitud])
                                .bindPopup(popupContent);

                            grupos[grupo].addLayer(marcadorLayer);
                        });
                    });

                    // Añade los grupos de capas al mapa
                    Object.keys(grupos).forEach(grupo => {
                        map.addLayer(grupos[grupo]);
                    });

                    // Agrega control de capas al mapa
                    L.control.layers(null, grupos, { collapsed: false }).addTo(map);

                    // Ajusta el zoom y centra el mapa en la ubicación del usuario
                    map.setView(userLocation, 16);
                });
            } else {
                // Si el navegador no soporta geolocalización, establece una ubicación predeterminada
                map.setView([0, 0], 2);
                // Agrega capa de OpenStreetMap al mapa
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '© OpenStreetMap contributors'
                }).addTo(map);

                // Resto del código para agregar marcadores y grupos de capas
                // ...
            }
        });
    </script>

</body>
</html>
